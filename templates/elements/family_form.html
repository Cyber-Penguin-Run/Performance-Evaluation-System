
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    // This code empowers all input tags having a placeholder and data-slots attribute
    document.addEventListener('DOMContentLoaded', () => {
        for (const el of document.querySelectorAll("[placeholder][data-slots]")) {
            const pattern = el.getAttribute("placeholder"),
                slots = new Set(el.dataset.slots || "_"),
                prev = (j => Array.from(pattern, (c,i) => slots.has(c)? j=i+1: j))(0),
                first = [...pattern].findIndex(c => slots.has(c)),
                accept = new RegExp(el.dataset.accept || "\\d", "g"),
                clean = input => {
                    input = input.match(accept) || [];
                    return Array.from(pattern, c =>
                        input[0] === c || slots.has(c) ? input.shift() || c : c
                    );
                },
                format = () => {
                    const [i, j] = [el.selectionStart, el.selectionEnd].map(i => {
                        i = clean(el.value.slice(0, i)).findIndex(c => slots.has(c));
                        return i<0? prev[prev.length-1]: back? prev[i-1] || first: i;
                    });
                    el.value = clean(el.value).join``;
                    el.setSelectionRange(i, j);
                    back = false;
                };
            let back = false;
            el.addEventListener("keydown", (e) => back = e.key === "Backspace");
            el.addEventListener("input", format);
            el.addEventListener("focus", format);
            el.addEventListener("blur", () => el.value === pattern && (el.value=""));
        }
    });


    function showForm(form_name) {
            $(form_name).show()
        }

    $(document).ready(() => {

        var students = []
        var parents = []


    })

    </script>



{%extends 'authed_base.html' %}
{% block content %}

<form  class="form-control text-center align-items-center" method = "POST">

    <div class="row d-flex">
        <h2>Family Information</h2>
        <label for="familyName" class="sr-only my-1"><strong>Family Name</strong></label>
        <input class="mx-auto " style="width: 25%;" type="text" id="familyName" name="familyName" value = "{{family['familyName']}}" minlength="5" maxlength="24" placeholder="Family Name" required autofocus />    
    </div>

    <div class="row">

        <div class="col-6 d-flex flex-column">
            <label for="studentsNbr" class="sr-only my-1"><strong># of Students</strong></label>
            <input class="mx-auto " style="width: 25%;" type="text" id="studentsNbr" name="studentsNbr"  value = "{{family['students']|length}}" minlength="5" maxlength="24" placeholder="Family Name" required autofocus />    
        </div>
        
        <div class="col-6 d-flex flex-column">
            <label for="familyName" class="sr-only my-1"><strong>Status</strong></label>
            <select class="mx-auto " style="width: 25%;" type="text" id="familyName" name="familyName" minlength="5" maxlength="24" placeholder="Family Name" required autofocus></select>    
        </div>

    </div>

    
    <div class="d-flex flex-wrap w-75 mx-auto my-3 justify-content-around" style="border-radius: 10px; background-color: beige">

        <div class="mx-1" style="width:45%; min-width: 300px;">
            <h4>Parents</h4>



                {% for parent in family['parents'] %}

                    <div class="card d-flex flex-row p-2">
                        <strong>{{parent['firstName']}} {{parent['lastName']}}</strong>
                        <div class="ms-auto">
                            <a>
                                <img src="{{ url_for('static', filename='img/edit-icon.svg') }}"/>
                            </a>
                            <a>
                                <img src="{{ url_for('static', filename='img/delete-icon.svg') }}"/>
                            </a>
                        </div>
                    </div>

                {%endfor%}



                <button onclick="showForm('#parent_form')" class="btn btn-outline-success rounded-circle m-2"><strong>+</strong></button>


        </div>

        <div class="mx-1" style="width: 45%; min-width: 300px;">
            <h4>Students</h4>


                {% for student in family['students'] %}

                    <div class="card d-flex flex-row p-2">
                        <strong>{{student['firstName']}} {{student['lastName']}}</strong>
                        <div class="ms-auto">
                            <a>
                                <img src="{{ url_for('static', filename='img/edit-icon.svg') }}"/>
                            </a>
                            <a>
                                <img src="{{ url_for('static', filename='img/delete-icon.svg') }}"/>
                            </a>
                        </div>
                    </div>

                {%endfor%}

                <button onclick="showForm('#student_form')" class="btn btn-outline-success rounded-circle m-2"><strong>+</strong></button>

        </div>

    </div>

    <button class="btn btn-primary enrichery-primary" type = "submit" value = "Submit">Submit</button>

    
</form>



<!--FORMS-->



<div id="parent_form" class="enrichery-center-form-wrapper" style="display: none;">
    {% with hasFamily=True %}
        {%include "elements/parents_form.html"%}
    {% endwith %}
</div>




<div id="student_form" class="enrichery-center-form-wrapper", style="display: none;">

    {% with hasFamily=True %}
        {%include "elements/students_form.html"%}
    {% endwith %}

</div>




{%endblock content %}




<!--     PARENT FORM     -->









